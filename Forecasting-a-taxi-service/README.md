# Прогнозирование количества заказов для сервиса такси

**Введение.**

Сервис такси собрал исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Необходимо построить модель машиннгого обучения для такого предсказания. Значение метрики RMSE на тестовой выборке должно быть не больше 48.
#


**Данные.**

В Исходных данных представлена информация о количестве заказов `num_orders` для каждого временного промежутка `datetime в 10 минут`. Период - `с 1 марта 2018 по 31 августа 2018`, количество периодов - 24 496. Проведено ресемплирование данных (новый период - 1 час).
#

**Исследовательский анализ.**

Построены графики до ресемплирования и после, по которым можно сделать вывод: `количество заказов в среднем остается на одинаковом уровне изо дня в день с тенденицей к увеличению`. Среднее количество заказов - `50-100 заказов в час`. При этом данное значение постепенно увеличивается от месяца к месяцу.

Количество заказов имеет четкую `суточную сезонность`: пик всегда приходится на ночь и на 16:00, а наименьшее количество - на 6:00. Также заметна `недельная сезонность`: пик приходится на понедельник и пятницу, а минимум заказов - во вторник.
#

**Машинное обучение.**

Подготовлены `новые признаки`: час в сутках, день недели, признаки "отстающих значений" (максимальное отставание - 168 часов) и "скользящее среднее" (окно - 168 часов). Подготовлены обучающая и тестовая выборки (4:1), проведено масштабирование данных методом стандартизации. Для обучения использованы следующие модели: `LinearRegression`, `StackingRegressor` (базовые модели - две LinearRegression, мета-модель - RandomForestRegressor), `RandomForestRegressor`, `CatBoostRegressor`.
#

**Результаты.**

`Лучшая модель на этапе валидации - LinearRegression` (особенно с учетом времени обучения). Показатель `RMSE на этапе вылидации - 21.8`. Модель прошла проверку на адекватность: метрика лучше, чем при простом предсказании количества заказов медианным числом или предыдущим значением ряда. Качество модели проверено на 20% тестовых данных, итоговая метрика `RMSE - 32.0`. Задача, поставленная заказчиком, выполнена.
