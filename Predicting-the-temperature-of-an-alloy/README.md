# Предсказание температуры сплава с целью уменьшения потребления электроэнергии для металлургической компании.

**Описание задачи.**

Чтобы оптимизировать производственные расходы, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава. Задача — построить модель, которая будет её предсказывать. Заказчик хочет использовать разработанную модель для имитации технологического процесса.

**Цель проекта:** разработать модель машинного обучения, которая будет предсказывать температуру стали во времени с целью оптимизации расходов производства.

**План проекта.**
1. Загрузка необходимых библиотек.
2. Загрузка и обзор данных.
3. Предобработка данных.
4. Исследовательский анализ данных.
5. Подготовка данных и выбор признаков.
6. Подготовка тренировочной и тестовой выборок.
7. Создание пайплайна обучения.
8. Создание моделей машинного обучения.
9. Обучение моделей.
10. Сравние лучшей модели с константной моделью.
11. Тестирование лучшей модели.
12. Подведение итогов и разработка рекомендаций для заказчика.
13. Отчет о проекте.

<div style="border: solid black 4px; padding: 10px; border-radius: 10px">

**Хронология процесса на примере партии №1.**

Начало процесса.
1. Итерация №1:
- 2019-05-03 11:02:04 - измерение температуры (1571.0), анализ химического состава, отбор пробы
- 2019-05-03 11:02:14 - начало нагрева
- 2019-05-03 11:06:02 - конец нагрева: активная мощность - 0.305130, реактивная мощность - 0.211253
- 2019-05-03 11:06:19 - подача проволочных материалов (Wire 1: 60.059998)
- продувание инертным газом (объем: 29.749986), перемешивание сплава

2. Итерация №2:
- 2019-05-03 11:07:18 - измерение температуры (1604.0), анализ химического состава, отбор пробы
- 2019-05-03 11:07:28 - начало нагрева
- 2019-05-03 11:10:33 - конец нагрева: активная мощность - 0.765658, реактивная мощность - 0.477438
- 2019-05-03 11:10:43 - подача сыпучих материалов (Bulk 15: 154.0)
- продувание инертным газом (объем: 29.749986), перемешивание сплава

3. Итерация №3:
- 2019-05-03 11:11:34 - измерение температуры (1618.0), анализ химического состава, отбор пробы
- 2019-05-03 11:11:44 - начало нагрева 
- 2019-05-03 11:14:36 - конец нагрева: активная мощность - 0.580313, реактивная мощность - 0.430460
- 2019-05-03 11:14:50 - подача сыпучих материалов (Bulk 14: 150.0)
- продувание инертным газом (объем: 29.749986), перемешивание сплава

4. Итерация №4:
- 2019-05-03 11:18:04 - измерение температуры (1601.0), анализ химического состава, отбор пробы
- 2019-05-03 11:18:14 - начало нагрева
- 2019-05-03 11:24:19 - конец нагрева: активная мощность - 0.518496, реактивная мощность - 0.379979
- 2019-05-03 11:24:31 - подача сыпучих материалов (Bulk 12: 206.0)
- продувание инертным газом (объем: 29.749986), перемешивание сплава

5. Итерация №5:
- 2019-05-03 11:25:59 - измерение температуры (1606.0), анализ химического состава, отбор пробы
- 2019-05-03 11:26:09 - начало нагрева 
- 2019-05-03 11:28:37 - конец нагрева: активная мощность - 0.867133, реактивная мощность - 0.643691
- 2019-05-03 11:28:48 - подача сыпучих материалов (Bulk 4: 43.0)
- продувание инертным газом (объем: 29.749986), перемешивание сплава

6. Итерация №6:
- 2019-05-03 11:30:38 - измерение температуры (1613.0), анализ химического состава, отбор пробы

Конец процесса.

**Построение пайплайна и обучение моделей.**

Для предсказания температуры были использованы две модели: `Linear Regression` и `CatBoostRegressor`. Каждая модель была объединена в `Pipeline` с объектом масштабирования `StandardScaler`. Подбор гиперпараметров осуществлялся с помощью `GridSearchCV`. Проверка проводилась на 25% тестовых данных. Итоговая метрика была достигнута с помощью обеих моделей, однака лучший результат показала линейная регрессия.

**Анализ важности признаков.**

Были изучен влияние каждого признака в предсказание конечной температуры с помощью библиотеки `shap`. Признаками с наибольшим вкладом стали суммарные объемы сыпучих и проволочных материалов, а также 2 проволочных материала (wire_1 и wire_2). Анализ важности признаков показал, что ни начальная температура, ни мощность, ни время нагревания не вляют так сильно, как объем добавляемых сыпучих и проволочных материалов.

**Перспективы.**

Дальнейшая работа в этом направлении может существенно улучшить как предсказание конечной температуры, так и экономию средств на электроэнергии. Во-первых, можно улучшить модель линейной регрессии, добавив в обучение новые признаки: физические и химические свойства добавляемых материалов, их вес, а также свойства первоначального сплава. В-третьих, можно использовать данную модель не только для предсказания конечной температуры, но и общей стоимости процесса, что позволит изучить влияние каждого этапа и компонента на экономику процесса напрямую. Во-вторых, сама модель машинного обучения может быть расширена посредством использования таких ансамблевых методов, как стекинг или бэггинг, что позволит предсказывать результат с помощью целого каскада моделей.
